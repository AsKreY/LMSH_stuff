150567511 --- помылка на кф.
Будем перебирать столбцы, а на самих стобцах строить ДП по профилю. Мы перебираем все возможные маски, подходящие под первый столб, потом переходим ко второму и ищем маски для него, заметим, что столбец при наличии предыдущего полностью определяется верхним элементом. Зная это несложно построить дп, добавив пару проверок на корректность масок
